----------------------------------------------------------------
-- Generated by eu.giulioquaresima.unicam.turns.domain.ddl.DDL --
-- at 2021-12-11T21:57:54.785469934Z                          --
----------------------------------------------------------------

    create table location (
       id bigint generated by default as identity,
        version timestamp,
        tenant_id bigint,
        primary key (id)
    );

    create table service (
       id bigint generated by default as identity,
        version timestamp,
        location_id bigint,
        session_scheduler_id bigint,
        primary key (id)
    );

    create table service_reception (
       id bigint generated by default as identity,
        version timestamp,
        service_id bigint,
        primary key (id)
    );

    create table session (
       id bigint generated by default as identity,
        version timestamp,
        end_time timestamp,
        name varchar(255),
        start_time timestamp,
        ticket_source_id bigint,
        primary key (id)
    );

    create table session_configuration (
       id bigint generated by default as identity,
        version timestamp,
        primary key (id)
    );

    create table session_scheduling (
       id bigint generated by default as identity,
        version timestamp,
        primary key (id)
    );

    create table session_scheduling_default_shifts (
       session_scheduling_id bigint not null,
        day_of_week integer,
        duration bigint,
        name varchar(255) not null,
        reset_ticket_source boolean not null,
        start_time time
    );

    create table tenant (
       id bigint generated by default as identity,
        version timestamp,
        name varchar(255),
        primary key (id)
    );

    create table ticket (
       id bigint generated by default as identity,
        version timestamp,
        label varchar(8),
        seq integer not null,
        service_reception_id bigint,
        session_id bigint not null,
        user_id bigint,
        primary key (id)
    );

    create table ticket_source (
       id bigint generated by default as identity,
        version timestamp,
        service_id bigint,
        ticket_source_configuration_id bigint,
        primary key (id)
    );

    create table ticket_source_configuration (
       id bigint generated by default as identity,
        version timestamp,
        digits varchar(255),
        minimum_ticket_label_length integer not null,
        postpone_enabled boolean not null,
        primary key (id)
    );

    create table user (
       id bigint generated by default as identity,
        version timestamp,
        primary key (id)
    );

    alter table location 
       add constraint FKnn6oi51wywywpykyqbr9aqb87 
       foreign key (tenant_id) 
       references tenant;

    alter table service 
       add constraint FKa72hqlm2hy63lgmvjqhen5imv 
       foreign key (location_id) 
       references location;

    alter table service 
       add constraint FKjsfctm8bdd5nsdbeharam5q9b 
       foreign key (session_scheduler_id) 
       references session_scheduling;

    alter table service_reception 
       add constraint FK2sjp0wg8r62igo3u7lsnya2xl 
       foreign key (service_id) 
       references service;

    alter table session 
       add constraint FK5od48nmiagthv6dw8x7wiqwn5 
       foreign key (ticket_source_id) 
       references ticket_source;

    alter table session_scheduling_default_shifts 
       add constraint FKpdkye21o2hsxjkhcupi1habwx 
       foreign key (session_scheduling_id) 
       references session_scheduling;

    alter table ticket 
       add constraint FKmob5fn4nw0022qhph1kak2576 
       foreign key (service_reception_id) 
       references service_reception;

    alter table ticket 
       add constraint FK5x0dvk4itqbdpu2dxdo02b5f7 
       foreign key (session_id) 
       references session;

    alter table ticket 
       add constraint FKdvt57mcco3ogsosi97odw563o 
       foreign key (user_id) 
       references user;

    alter table ticket_source 
       add constraint FKaxjf00j1ykoocar95jif184fk 
       foreign key (service_id) 
       references service;

    alter table ticket_source 
       add constraint FKddpiblmdr0xa8tsi6g17gycp2 
       foreign key (ticket_source_configuration_id) 
       references ticket_source_configuration;
